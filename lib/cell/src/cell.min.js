"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.Cell=void 0;var _xeUtils=_interopRequireDefault(require("xe-utils/methods/xe-utils")),_conf=_interopRequireDefault(require("../../conf")),_vXETable=_interopRequireDefault(require("../../v-x-e-table")),_tools=require("../../tools");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function renderTitleContent(e,r){return[e("span",{class:"vxe-cell--title"},r)]}var Cell={createColumn:function(e,r){var l=r.type,n=r.sortable,t=r.remoteSort,o=r.filters,d=r.editRender,i=r.treeNode,c=e.editConfig,a=e.editOpts,s=e.checkboxOpts,u={renderHeader:this.renderDefaultHeader,renderCell:i?this.renderTreeCell:this.renderDefaultCell,renderFooter:this.renderDefaultFooter};switch(l){case"seq":u.renderHeader=this.renderIndexHeader,u.renderCell=i?this.renderTreeIndexCell:this.renderIndexCell;break;case"radio":u.renderHeader=this.renderRadioHeader,u.renderCell=i?this.renderTreeRadioCell:this.renderRadioCell;break;case"checkbox":u.renderHeader=this.renderSelectionHeader,u.renderCell=s.checkField?i?this.renderTreeSelectionCellByProp:this.renderSelectionCellByProp:i?this.renderTreeSelectionCell:this.renderSelectionCell;break;case"expand":u.renderCell=this.renderExpandCell,u.renderData=this.renderExpandData;break;case"html":u.renderCell=i?this.renderTreeHTMLCell:this.renderHTMLCell,o&&(n||t)?u.renderHeader=this.renderSortAndFilterHeader:n||t?u.renderHeader=this.renderSortHeader:o&&(u.renderHeader=this.renderFilterHeader);break;default:c&&d?(u.renderHeader=this.renderEditHeader,u.renderCell="cell"===a.mode?i?this.renderTreeCellEdit:this.renderCellEdit:i?this.renderTreeRowEdit:this.renderRowEdit):o&&(n||t)?u.renderHeader=this.renderSortAndFilterHeader:n||t?u.renderHeader=this.renderSortHeader:o&&(u.renderHeader=this.renderFilterHeader)}return _tools.UtilTools.getColumnConfig(e,r,u)},renderDefaultHeader:function(e,r){var l=r.$table,n=r.column,t=n.slots,o=n.own,o=o.editRender||o.cellRender;if(t&&t.header)return renderTitleContent(e,t.header.call(l,r,e));if(o){t=_vXETable.default.renderer.get(o.name);if(t&&t.renderHeader)return renderTitleContent(e,t.renderHeader.call(l,e,o,r,{$grid:l.$xegrid,$table:l}))}return renderTitleContent(e,_tools.UtilTools.formatText(n.getTitle(),1))},renderDefaultCell:function(e,r){var l=r.$table,n=r.row,t=r.column,o=t.slots,d=t.own,i=d.editRender||d.cellRender;if(o&&o.default)return o.default.call(l,r,e);if(i){var c=d.editRender?"renderCell":"renderDefault",o=_vXETable.default.renderer.get(i.name);if(o&&o[c])return o[c].call(l,e,i,Object.assign({$type:d.editRender?"edit":"cell"},r),{$grid:l.$xegrid,$table:l})}return[_tools.UtilTools.formatText(_tools.UtilTools.getCellLabel(n,t,r),1)]},renderTreeCell:function(e,r){return Cell.renderTreeIcon(e,r,Cell.renderDefaultCell.call(this,e,r))},renderDefaultFooter:function(e,r){var l=r.$table,n=r.column,t=r._columnIndex,o=r.items,d=n.slots,n=n.own,n=n.editRender||n.cellRender;if(d&&d.footer)return d.footer.call(l,r,e);if(n){d=_vXETable.default.renderer.get(n.name);if(d&&d.renderFooter)return d.renderFooter.call(l,e,n,r,{$grid:l.$xegrid,$table:l})}return[_tools.UtilTools.formatText(o[t],1)]},renderTreeIcon:function(e,r,l){var n=r.$table,t=r.isHidden,o=n.treeOpts,d=n.treeExpandeds,i=n.treeLazyLoadeds,c=r.row,a=r.column,s=r.level,u=a.slots,f=o.children,x=o.hasChild,h=o.indent,C=o.lazy,v=o.trigger,b=o.iconLoaded,p=o.iconOpen,T=o.iconClose,k=c[f],_=!1,a=!1,o=!1,f={};return u&&u.icon?u.icon.call(n,r,e,l):(t||(a=-1<d.indexOf(c),C&&(o=-1<i.indexOf(c),_=c[x])),v&&"default"!==v||(f.click=function(e){return n.triggerTreeExpandEvent(e,r)}),[e("div",{class:["vxe-cell--tree-node",{"is--active":a}],style:{paddingLeft:"".concat(s*h,"px")}},[k&&k.length||_?[e("div",{class:"vxe-tree--btn-wrapper",on:f},[e("i",{class:["vxe-tree--node-btn",o?b||_conf.default.icon.TABLE_TREE_LOADED:a?p||_conf.default.icon.TABLE_TREE_OPEN:T||_conf.default.icon.TABLE_TREE_CLOSE]})])]:null,e("div",{class:"vxe-tree-cell"},l)])])},renderIndexHeader:function(e,r){var l=r.$table,n=r.column,t=n.slots;return renderTitleContent(e,t&&t.header?t.header.call(l,r,e):_tools.UtilTools.formatText(n.getTitle(),1))},renderIndexCell:function(e,r){var l=r.$table,n=r.column,t=l.seqOpts,o=n.slots;if(o&&o.default)return o.default.call(l,r,e);o=r.$seq,l=r.seq,e=r.level,n=t.seqMethod||n.seqMethod;return[_tools.UtilTools.formatText(n?n(r):e?"".concat(o,".").concat(l):t.startIndex+l,1)]},renderTreeIndexCell:function(e,r){return Cell.renderTreeIcon(e,r,Cell.renderIndexCell(e,r))},renderRadioHeader:function(e,r){var l=r.$table,n=r.column,t=n.slots;return renderTitleContent(e,t&&t.header?t.header.call(l,r,e):[e("span",{class:"vxe-radio--label"},_tools.UtilTools.formatText(n.getTitle(),1))])},renderRadioCell:function(e,r){var l,n=r.$table,t=r.column,o=r.isHidden,d=n.radioOpts,i=n.selectRow,c=t.slots,a=d.labelField,t=d.checkMethod,d=r.row,i=d===i,s=!!t;return o||(l={click:function(e){s||n.triggerRadioRowEvent(e,r)}},t&&(s=!t({row:d}))),[e("span",{class:["vxe-cell--radio",{"is--checked":i,"is--disabled":s}],on:l},[e("span",{class:"vxe-radio--icon vxe-radio--checked-icon"}),e("span",{class:"vxe-radio--icon vxe-radio--unchecked-icon"})].concat(c&&c.default?c.default.call(n,r,e):a?[e("span",{class:"vxe-radio--label"},_xeUtils.default.get(d,a))]:[]))]},renderTreeRadioCell:function(e,r){return Cell.renderTreeIcon(e,r,Cell.renderRadioCell(e,r))},renderSelectionHeader:function(e,r){var l,n=r.$table,t=r.column,o=r.isHidden,d=n.isIndeterminate,i=n.isAllCheckboxDisabled,c=t.slots,a=n.checkboxOpts,t=t.getTitle(),s=!1;return(a.checkStrictly?a.showHeader:!1!==a.showHeader)?(o||(s=!i&&n.isAllSelected,l={click:function(e){i||n.triggerCheckAllEvent(e,!s)}}),renderTitleContent(e,[e("span",{class:["vxe-cell--checkbox",{"is--checked":s,"is--disabled":i,"is--indeterminate":d}],attrs:{title:_conf.default.i18n("vxe.table.allTitle")},on:l},[e("span",{class:"vxe-checkbox--icon vxe-checkbox--checked-icon"}),e("span",{class:"vxe-checkbox--icon vxe-checkbox--unchecked-icon"}),e("span",{class:"vxe-checkbox--icon vxe-checkbox--indeterminate-icon"})].concat(c&&c.header?c.header.call(n,r,e):t?[e("span",{class:"vxe-checkbox--label"},t)]:[]))])):renderTitleContent(e,c&&c.header?c.header.call(n,r,e):[e("span",{class:"vxe-checkbox--label"},t)])},renderSelectionCell:function(e,r){var l,n=r.$table,t=r.row,o=r.column,d=r.isHidden,i=n.treeConfig,c=n.treeIndeterminates,a=n.checkboxOpts,s=a.labelField,u=a.checkMethod,a=o.slots,o=!1,f=!1,x=!!u;return d||(f=-1<n.selection.indexOf(t),l={click:function(e){x||n.triggerCheckRowEvent(e,r,!f)}},u&&(x=!u({row:t})),i&&(o=-1<c.indexOf(t))),[e("span",{class:["vxe-cell--checkbox",{"is--checked":f,"is--disabled":x,"is--indeterminate":o}],on:l},[e("span",{class:"vxe-checkbox--icon vxe-checkbox--checked-icon"}),e("span",{class:"vxe-checkbox--icon vxe-checkbox--unchecked-icon"}),e("span",{class:"vxe-checkbox--icon vxe-checkbox--indeterminate-icon"})].concat(a&&a.default?a.default.call(n,r,e):s?[e("span",{class:"vxe-checkbox--label"},_xeUtils.default.get(t,s))]:[]))]},renderTreeSelectionCell:function(e,r){return Cell.renderTreeIcon(e,r,Cell.renderSelectionCell(e,r))},renderSelectionCellByProp:function(e,r){var l,n=r.$table,t=r.row,o=r.column,d=r.isHidden,i=n.treeConfig,c=n.treeIndeterminates,a=n.checkboxOpts,s=a.labelField,u=a.checkField,f=a.halfField,x=a.checkMethod,a=o.slots,o=!1,h=!1,C=!!x;return d||(h=_xeUtils.default.get(t,u),l={click:function(e){C||n.triggerCheckRowEvent(e,r,!h)}},x&&(C=!x({row:t})),i&&(o=-1<c.indexOf(t))),[e("span",{class:["vxe-cell--checkbox",{"is--checked":h,"is--disabled":C,"is--indeterminate":f&&!h?t[f]:o}],on:l},[e("span",{class:"vxe-checkbox--icon vxe-checkbox--checked-icon"}),e("span",{class:"vxe-checkbox--icon vxe-checkbox--unchecked-icon"}),e("span",{class:"vxe-checkbox--icon vxe-checkbox--indeterminate-icon"})].concat(a&&a.default?a.default.call(n,r,e):s?[e("span",{class:"vxe-checkbox--label"},_xeUtils.default.get(t,s))]:[]))]},renderTreeSelectionCellByProp:function(e,r){return Cell.renderTreeIcon(e,r,Cell.renderSelectionCellByProp(e,r))},renderExpandCell:function(e,r){var l=r.$table,n=r.isHidden,t=r.row,o=r.column,d=l.expandOpts,i=l.rowExpandeds,c=l.expandLazyLoadeds,a=d.lazy,s=d.labelField,u=d.iconLoaded,f=d.iconOpen,x=d.iconClose,h=d.visibleMethod,C=o.slots,d=!1,o=!1;return C&&C.icon?C.icon.call(l,r,e):(n||(d=-1<i.indexOf(r.row),a&&(o=-1<c.indexOf(t))),[!h||h(r)?e("span",{class:["vxe-table--expanded",{"is--active":d}],on:{click:function(e){l.triggerRowExpandEvent(e,r)}}},[e("i",{class:["vxe-table--expand-btn",o?u||_conf.default.icon.TABLE_EXPAND_LOADED:d?f||_conf.default.icon.TABLE_EXPAND_OPEN:x||_conf.default.icon.TABLE_EXPAND_CLOSE]})]):null,e("span",{class:"vxe-table--expand-label"},C&&C.default?C.default.call(l,r,e):s?_xeUtils.default.get(t,s):null)])},renderExpandData:function(e,r){var l=r.$table,n=r.column,t=n.slots,n=n.contentRender;if(t&&t.content)return t.content.call(l,r,e);if(n){t=_vXETable.default.renderer.get(n.name);if(t&&t.renderExpand)return t.renderExpand.call(l,e,n,r,{$grid:l.$xegrid,$table:l})}return[]},renderHTMLCell:function(e,r){var l=r.$table,n=r.row,t=r.column,o=t.slots;return o&&o.default?o.default.call(l,r,e):[e("span",{class:"vxe-cell--html",domProps:{innerHTML:_tools.UtilTools.formatText(_tools.UtilTools.getCellLabel(n,t,r),1)}})]},renderTreeHTMLCell:function(e,r){return Cell.renderTreeIcon(e,r,Cell.renderHTMLCell(e,r))},renderSortAndFilterHeader:function(e,r){return Cell.renderDefaultHeader(e,r).concat(Cell.renderSortIcon(e,r)).concat(Cell.renderFilterIcon(e,r))},renderSortHeader:function(e,r){return Cell.renderDefaultHeader(e,r).concat(Cell.renderSortIcon(e,r))},renderSortIcon:function(e,r){var l=r.$table,n=r.column,t=l.sortOpts,o=t.showIcon,r=t.iconAsc,t=t.iconDesc;return!1===o?[]:[e("span",{class:"vxe-cell--sort"},[e("i",{class:["vxe-sort--asc-btn",r||_conf.default.icon.TABLE_SORT_ASC,{"sort--active":"asc"===n.order}],attrs:{title:_conf.default.i18n("vxe.table.sortAsc")},on:{click:function(e){l.triggerSortEvent(e,n,"asc")}}},[e("svg",{attrs:{viewBox:"0 0 16 8",width:"16px",height:"8px"},domProps:{innerHTML:'\n                <g id="画板" stroke="none" stroke-width="1" fill-rule="evenodd">\n                    <path d="M7.55803708,2.49069051 L4.63890187,6.19028212 C4.4678494,6.40706696 4.50492282,6.72147121 4.72170766,6.89252367 C4.80993448,6.96213839 4.91904146,7 5.03142554,7 L10.9507721,7 C11.2269145,7 11.4507721,6.77614237 11.4507721,6.5 C11.4507721,6.38532418 11.4113531,6.27413338 11.3391221,6.18506466 L8.33891077,2.48547306 C8.16497679,2.27099327 7.85010521,2.2381244 7.63562542,2.41205838 C7.60693772,2.43532288 7.58091617,2.4616945 7.55803708,2.49069051 Z" id="up/fill"></path>\n                </g>\n              '}})]),e("i",{class:["vxe-sort--desc-btn",t||_conf.default.icon.TABLE_SORT_DESC,{"sort--active":"desc"===n.order}],attrs:{title:_conf.default.i18n("vxe.table.sortDesc")},on:{click:function(e){l.triggerSortEvent(e,n,"desc")}}},[e("svg",{attrs:{viewBox:"0 0 16 8",width:"16px",height:"8px"},domProps:{innerHTML:'\n                <g id="画板" stroke="none" stroke-width="1" fill-rule="evenodd">\n                  <path d="M7.55803708,1.49069051 L4.63890187,5.19028212 C4.4678494,5.40706696 4.50492282,5.72147121 4.72170766,5.89252367 C4.80993448,5.96213839 4.91904146,6 5.03142554,6 L10.9507721,6 C11.2269145,6 11.4507721,5.77614237 11.4507721,5.5 C11.4507721,5.38532418 11.4113531,5.27413338 11.3391221,5.18506466 L8.33891077,1.48547306 C8.16497679,1.27099327 7.85010521,1.2381244 7.63562542,1.41205838 C7.60693772,1.43532288 7.58091617,1.4616945 7.55803708,1.49069051 Z" id="down/fill" transform="translate(8.000000, 3.500000) scale(1, -1) translate(-8.000000, -3.500000) "></path>\n                </g>\n              '}})])])]},renderFilterHeader:function(e,r){return Cell.renderDefaultHeader(e,r).concat(Cell.renderFilterIcon(e,r))},renderFilterIcon:function(e,r){var l=r.$table,n=r.column,t=r.hasFilter,o=l.filterStore,d=l.filterOpts,i=d.showIcon,c=d.iconNone,d=d.iconMatch;return!1===i?[]:[e("span",{class:["vxe-cell--filter",{"is--active":o.visible&&o.column===n}]},[e("i",{class:["vxe-filter--btn",t?d||_conf.default.icon.TABLE_FILTER_MATCH:c||_conf.default.icon.TABLE_FILTER_NONE],attrs:{title:_conf.default.i18n("vxe.table.filter")},on:{click:function(e){l.triggerFilterEvent(e,r.column,r)}}},[e("svg",{attrs:{viewBox:"0 0 24 24",width:"100%",height:"100%"},domProps:{innerHTML:'<g id="icon-/-filter" stroke="none" stroke-width="1" fill-rule="evenodd">\n                <path d="M9.14662963,18.2982456 C9.14662963,18.6864035 9.39513883,19 9.70315024,19 L14.2953204,19 C14.6033318,19 14.851841,18.6864035 14.851841,18.2982456 L14.851841,14.4646233 L9.14662963,14.4646233 L9.14662963,18.2982456 Z M17.5210491,5 L6.47763999,5 C6.11012638,5 5.88061787,5.50377358 6.06512471,5.90566038 L9.12413103,13 L14.8681932,13 L17.9365645,5.90566038 C18.1180712,5.50377358 17.8885627,5 17.5210491,5 Z"></path>\n              </g>'}})])])]},renderEditHeader:function(e,r){var l,n=r.$table,t=r.column,o=n.editRules,d=n.editOpts,i=t.sortable,n=t.remoteSort,t=t.filters;return!o||(o=_xeUtils.default.get(o,r.column.property))&&(l=o.some(function(e){return e.required})),[l?e("i",{class:"vxe-required-icon"}):null,!1===d.showIcon?null:e("i",{class:["vxe-edit-icon",d.icon||_conf.default.icon.TABLE_EDIT]})].concat(Cell.renderDefaultHeader(e,r)).concat(i||n?Cell.renderSortIcon(e,r):[]).concat(t?Cell.renderFilterIcon(e,r):[])},renderRowEdit:function(e,r){var l=r.$table.editStore.actived;return Cell.runRenderer(e,r,this,l&&l.row===r.row)},renderTreeRowEdit:function(e,r){return Cell.renderTreeIcon(e,r,Cell.renderRowEdit(e,r))},renderCellEdit:function(e,r){var l=r.$table.editStore.actived;return"click"===r.$table.editConfig.trigger?Cell.runRenderer(e,r,this,!0):Cell.runRenderer(e,r,this,l&&l.row===r.row&&l.column===r.column)},renderTreeCellEdit:function(e,r){return Cell.renderTreeIcon(e,r,Cell.renderCellEdit(e,r))},runRenderer:function(e,r,l,n){var t=r.$table,o=r.row,d=r.column,i=d.slots,c=d.own,a=d.formatter,s=c.editRender,c=_vXETable.default.renderer.get(s.name);return n?i&&i.edit?i.edit.call(t,r,e):c&&c.renderEdit?c.renderEdit.call(t,e,s,Object.assign({$type:"edit"},r),{$grid:t.$xegrid,$table:t}):[]:i&&i.default?i.default.call(t,r,e):a?[_tools.UtilTools.formatText(_tools.UtilTools.getCellLabel(o,d,r),1)]:Cell.renderDefaultCell.call(l,e,r)}},_default=exports.Cell=Cell;exports.default=Cell;